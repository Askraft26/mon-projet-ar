<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>XR Video Player - AR & VR</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    
    <style>
      .buttons {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 10;
        display: flex;
        gap: 10px;
      }
      button { padding: 10px; cursor: pointer; }
    </style>
  </head>

  <body style="margin: 0; overflow: hidden;">

    <a-scene 
      embedded 
      arjs="sourceType: webcam; debugUIEnabled: false;" 
      renderer="logarithmicDepthBuffer: true;"
      vr-mode-ui="enabled: true">

      <a-assets>
        <video id="maVideo" 
               src="https://www.w3schools.com/html/mov_bbb.mp4" 
               crossorigin="anonymous" 
               playsinline 
               webkit-playsinline>
        </video>
      </a-assets>

      <a-marker preset="hiro">
        <a-entity rotation="-90 0 0" position="0 0 0">
          
          <a-video src="#maVideo" width="2" height="1.125" position="0 0.5 0"></a-video>

          <a-entity position="0 -0.5 0.1">
            <a-box id="btn-play" position="0 0 0" scale="0.3 0.3 0.1" color="#4CC3D9" class="clickable">
              <a-text value="P" align="center" position="0 0 0.6" scale="2 2 2"></a-text>
            </a-box>

            <a-box id="btn-back" position="-0.5 0 0" scale="0.3 0.3 0.1" color="#FFC65D" class="clickable">
              <a-text value="<<" align="center" position="0 0 0.6" scale="2 2 2"></a-text>
            </a-box>

            <a-box id="btn-forward" position="0.5 0 0" scale="0.3 0.3 0.1" color="#FFC65D" class="clickable">
              <a-text value=">>" align="center" position="0 0 0.6" scale="2 2 2"></a-text>
            </a-box>
          </a-entity>

        </a-entity>
      </a-marker>

      <a-entity camera look-controls>
        <a-cursor 
          id="cursor"
          animation__click="property: scale; startEvents: click; from: 0.1 0.1 0.1; to: 1 1 1; dur: 150"
          animation__fusing="property: fusing; startEvents: fusing; from: 1 1 1; to: 0.1 0.1 0.1; dur: 1500"
          event-set__mouseenter="_event: mouseenter; color: springgreen"
          event-set__mouseleave="_event: mouseleave; color: black"
          raycaster="objects: .clickable">
        </a-cursor>
      </a-entity>

    </a-scene>

    <script>
      const video = document.querySelector("#maVideo");
      const btnPlay = document.querySelector("#btn-play");
      const btnBack = document.querySelector("#btn-back");
      const btnForward = document.querySelector("#btn-forward");

      // Logique Play/Pause
      btnPlay.addEventListener('click', function() {
        if (video.paused) {
          video.play();
          btnPlay.setAttribute('color', '#EF2D5E');
        } else {
          video.pause();
          btnPlay.setAttribute('color', '#4CC3D9');
        }
      });

      // Reculer de 5 secondes
      btnBack.addEventListener('click', function() {
        video.currentTime -= 5;
      });

      // Avancer de 5 secondes
      btnForward.addEventListener('click', function() {
        video.currentTime += 5;
      });

      // Interaction tactile (pour mobile hors VR)
      window.addEventListener('touchstart', function() {
        // Démarre la vidéo au premier toucher (contrainte navigateur)
        if (video.paused && video.currentTime === 0) video.play();
      });
    </script>
  </body>
</html>
