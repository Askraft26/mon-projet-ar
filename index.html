<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AR Video - Emojis & Écran Interactif</title>
  
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

  <style>
    body { margin: 0; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
    
    #overlay {
      position: absolute; z-index: 999; top: 0; left: 0; width: 100%; height: 100%;
      background: radial-gradient(circle, #1a1a1a 0%, #000 100%);
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      color: white; text-align: center;
      transition: opacity 0.5s ease-out;
    }
    .btn-start {
      padding: 15px 40px; border: 2px solid #00E676; border-radius: 30px;
      background: rgba(0, 230, 118, 0.1); color: #00E676; font-weight: bold;
      cursor: pointer; margin-top: 20px;
    }
  </style>
</head>

<body style="margin:0; overflow:hidden;">

  <div id="overlay">
    <div>
      <h1 style="letter-spacing: 5px; color: #00E676;">AR HOLO PLAYER</h1>
      <p style="opacity: 0.8;">Déclenchez l'hologramme avec le marqueur Hiro.</p>
      <div class="btn-start">ACTIVER L'EXPÉRIENCE</div>
    </div>
  </div>

  <a-scene embedded
           arjs="sourceType: webcam; trackingMethod: best; debugUIEnabled: false;"
           renderer="antialias: true; colorManagement: true; precision: medium;">
    
    <a-assets>
      <video id="maVideo" src="V2.mp4" crossorigin="anonymous" playsinline webkit-playsinline></video>
    </a-assets>

    <a-marker preset="hiro" id="hiroMarker">
        <a-torus color="#00E676" arc="360" radius="0.5" radius-tubular="0.02" rotation="90 0 0">
            <a-animation property="rotation" to="90 360 0" dur="3000" repeat="indefinite" easing="linear"></a-animation>
        </a-torus>
    </a-marker>

    <a-entity id="fixedContent" visible="false" position="0 1.6 -4">
      
      <a-entity id="screen-container">
        <a-video id="interactive-video" class="clickable" src="#maVideo" 
                 width="3.2" height="1.8" position="0 0 0" 
                 material="shader: flat; transparent: true; opacity: 0.9;"></a-video>
        <a-plane width="3.4" height="2" position="0 0 -0.05" 
                 material="shader: flat; color: #00E676; transparent: true; opacity: 0.2; blur: 0.1;"></a-plane>
      </a-entity>

      <a-entity id="progress-bar" position="0 -1 0.05">
        <a-plane id="bar-bg" width="3.2" height="0.05" color="#333"></a-plane>
        <a-plane id="bar-fill" width="0.1" height="0.05" color="#00E676" position="-1.6 0 0.01"></a-plane>
      </a-entity>

      <a-entity position="0 -1.4 0.1">
        
        <a-circle id="btn-play" class="clickable" radius="0.25" color="#FFF" 
                  animation__mouseenter="property: scale; to: 1.1 1.1 1.1; dur: 200; startEvents: mouseenter"
                  animation__mouseleave="property: scale; to: 1 1 1; dur: 200; startEvents: mouseleave">
          <a-text id="emoji-play" value="▶️" align="center" position="0 0 0.01" width="1.5" height="1.5"></a-text>
          <a-text id="emoji-pause" value="⏸️" align="center" position="0 0 0.01" width="1.5" height="1.5" visible="false"></a-text>
        </a-circle>

        <a-circle id="btn-back" class="clickable" position="-0.8 0 0" radius="0.18" color="#FFC65D" opacity="0.8"
                  animation__mouseenter="property: scale; to: 1.1 1.1 1.1; dur: 200; startEvents: mouseenter"
                  animation__mouseleave="property: scale; to: 1 1 1; dur: 200; startEvents: mouseleave">
          <a-text value="⏪" align="center" color="#000" position="0 0 0.01" width="1.5" height="1.5"></a-text>
        </a-circle>

        <a-circle id="btn-forward" class="clickable" position="0.8 0 0" radius="0.18" color="#FFC65D" opacity="0.8"
                  animation__mouseenter="property: scale; to: 1.1 1.1 1.1; dur: 200; startEvents: mouseenter"
                  animation__mouseleave="property: scale; to: 1 1 1; dur: 200; startEvents: mouseleave">
          <a-text value="⏩" align="center" color="#000" position="0 0 0.01" width="1.5" height="1.5"></a-text>
        </a-circle>

      </a-entity>
    </a-entity>

    <a-entity camera look-controls wasd-controls position="0 1.6 0">
        <a-cursor id="mainCursor" raycaster="objects: .clickable" color="#00E676" opacity="0.8"
            cursor="fuse: true; fuseTimeout: 1000">
            <a-animation begin="fusing" easing="ease-in" attribute="scale" fill="forwards" from="1 1 1" to="0.1 0.1 0.1" dur="1000"></a-animation>
            <a-animation begin="click" easing="ease-out" attribute="scale" fill="backwards" from="0.5 0.5 0.5" to="1 1 1" dur="150"></a-animation>
        </a-cursor>
    </a-entity>

  </a-scene>

  <script>
    const video = document.querySelector("#maVideo");
    const fixedContent = document.querySelector("#fixedContent");
    const barFill = document.querySelector("#bar-fill");
    
    const btnPlay = document.querySelector("#btn-play");
    const emojiPlay = document.querySelector("#emoji-play");
    const emojiPause = document.querySelector("#emoji-pause");
    const interactiveVideoScreen = document.querySelector("#interactive-video"); // L'écran vidéo lui-même

    // --- 1. Démarrage Premium (déblocage audio/vidéo) ---
    document.querySelector("#overlay").addEventListener('click', function() {
      this.style.display = 'none';
      video.play().then(() => video.pause()); // Préchauffage
    });

    // --- 2. Détection Hiro et apparition animée ---
    document.querySelector("#hiroMarker").addEventListener("markerFound", () => {
      if (!fixedContent.getAttribute("visible")) {
        fixedContent.setAttribute("visible", "true");
        fixedContent.setAttribute("animation", "property: scale; from: 0 0 0; to: 1 1 1; dur: 800; easing: easeOutBack;");
        togglePlayback(true); // Lance la vidéo au scan
      }
    });

    // --- 3. Logique Play/Pause centralisée ---
    function togglePlayback(forcePlay = false) {
      if (video.paused || forcePlay) {
        video.play();
        emojiPlay.setAttribute("visible", false);
        emojiPause.setAttribute("visible", true);
        btnPlay.setAttribute("color", "#00E676"); // Couleur verte pour "en lecture"
      } else {
        video.pause();
        emojiPlay.setAttribute("visible", true);
        emojiPause.setAttribute("visible", false);
        btnPlay.setAttribute("color", "#FFF"); // Couleur blanche pour "en pause"
      }
    }

    // --- 4. Interactions ---
    btnPlay.addEventListener('click', () => togglePlayback()); // Bouton Play/Pause
    interactiveVideoScreen.addEventListener('click', () => togglePlayback()); // Clic sur la vidéo

    document.querySelector("#btn-back").addEventListener('click', () => { video.currentTime -= 5; });
    document.querySelector("#btn-forward").addEventListener('click', () => { video.currentTime += 5; });

    // --- 5. Barre de progression fluide ---
    video.addEventListener('timeupdate', () => {
      let percent = video.currentTime / video.duration;
      if (isNaN(percent)) percent = 0;
      barFill.setAttribute("width", percent * 3.2);
      barFill.setAttribute("position", `${(percent * 3.2 / 2) - 1.6} 0 0.01`);
    });

    // --- 6. Synchronisation des icônes à la fin de la vidéo ---
    video.addEventListener('ended', () => {
        togglePlayback(false); // Passe en pause à la fin
        video.currentTime = 0; // Remet au début pour le prochain Play
    });

  </script>
</body>
</html>
```http://googleusercontent.com/image_generation_content/1
